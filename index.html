<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SCIP.NET Interface</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      background: #000;
      color: #00ff00;
      font-family: "Courier New", monospace;
      overflow: hidden;
    }

    #console {
      white-space: pre-wrap;
      padding: 20px;
      line-height: 1.2;
      font-size: 14px;
    }

    .cursor::after {
      content: "_";
      animation: blink 1s infinite;
    }

    @keyframes blink {
      50% { opacity: 0; }
    }

    #popup {
      display: none;
      position: absolute;
      top: 30%;
      left: 30%;
      width: 40%;
      height: 30%;
      background: rgba(0,0,0,0.9);
      border: 2px solid #00ff00;
      padding: 20px;
      color: #00ff00;
      z-index: 10;
    }

    #popup button {
      background: #000;
      color: #00ff00;
      border: 1px solid #00ff00;
      padding: 5px 10px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div id="console" class="cursor"></div>

  <div id="popup">
    <div id="popupContent"></div>
    <button id="closePopup">Close</button>
  </div>

  <script>
    const consoleEl = document.getElementById('console');
    const popup = document.getElementById('popup');
    const popupContent = document.getElementById('popupContent');
    const closeBtn = document.getElementById('closePopup');

    function printLine(line, delay=50) {
      return new Promise(resolve => {
        let i = 0;
        const interval = setInterval(() => {
          consoleEl.textContent += line[i];
          i++;
          if (i >= line.length) {
            clearInterval(interval);
            consoleEl.textContent += "\n";
            resolve();
          }
        }, delay);
      });
    }

    function randomLine(length=80) {
      const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()[]{}<>/\\|";
      let s = "";
      for (let i = 0; i < length; i++) {
        s += chars[Math.floor(Math.random() * chars.length)];
      }
      return s;
    }

    async function bootSequence() {
      document.removeEventListener('keydown', handleInput);
      consoleEl.textContent = "";

      // Static noise
      for (let i = 0; i < 20; i++) {
        consoleEl.textContent += randomLine() + "\n";
        await new Promise(r => setTimeout(r, 30));
      }

      consoleEl.textContent = "";

      // ASCII logo
      const ascii = `
███████╗ ██████╗██╗██████╗     ███╗   ██╗███████╗████████╗
██╔════╝██╔════╝██║██╔══██╗    ████╗  ██║██╔════╝╚══██╔══╝
███████╗██║     ██║██████═╝    ██╔██╗ ██║█████╗     ██║
╚════██║██║     ██║██║         ██║╚██╗██║██╔══╝     ██║
███████║╚██████╗██║██║         ██║ ╚████║███████╗   ██║
╚══════╝ ╚═════╝╚═╝╚═╝         ╚═╝  ╚═══╝╚══════╝   ╚═╝
      `;
      await printLine(ascii, 0);

      consoleEl.textContent += "\nInitializing system modules...\n";
      let bar = "[--------------------]";
      consoleEl.textContent += bar;
      let progress = 0;

      while (progress < 20) {
        progress++;
        bar = "[" + "#".repeat(progress) + "-".repeat(20 - progress) + "]";
        consoleEl.textContent = consoleEl.textContent.replace(/\[.*\]$/, bar);
        await new Promise(r => setTimeout(r, 150));
      }

      consoleEl.textContent += "\nSystem online.\n\n";
      await new Promise(r => setTimeout(r, 800));

      for (let i = 0; i < 10; i++) {
        consoleEl.textContent += randomLine() + "\n";
        await new Promise(r => setTimeout(r, 20));
      }

      consoleEl.textContent = ">> SCIP.NET Console Interface Ready.\nType 'help' for available commands.\n\n>> ";
      startCommandMode();
    }

    let currentInput = "";

    function handleInput(e) {
      if (e.key.length === 1) {
        currentInput += e.key;
        consoleEl.textContent += e.key;
      } else if (e.key === "Backspace") {
        if (currentInput.length > 0) {
          currentInput = currentInput.slice(0, -1);
          consoleEl.textContent = consoleEl.textContent.slice(0, -1);
        }
      } else if (e.key === "Enter") {
        consoleEl.textContent += "\n";
        executeCommand(currentInput.trim());
        currentInput = "";
      }
    }

    async function executeCommand(input) {
      const parts = input.split(" ");
      const cmd = parts[0].toLowerCase();

      switch (cmd) {
        case "help":
          consoleEl.textContent += "Available commands:\n";
          consoleEl.textContent += "help      - show this help message\n";
          consoleEl.textContent += "about     - system information\n";
          consoleEl.textContent += "access <#> - fetch SCP‑item info\n";
          consoleEl.textContent += "clear     - clear the console\n";
          consoleEl.textContent += "reboot    - restart boot sequence\n\n";
          consoleEl.textContent += ">> ";
          break;

        case "about":
          consoleEl.textContent += "SCIP.NET v1.0 :: Synthetic Cyber Intelligence Protocol\n";
          consoleEl.textContent += "Developed for secure neural data interfacing.\n\n>> ";
          break;

        case "clear":
          consoleEl.textContent = "";
          break;

        case "reboot":
          await bootSequence();
          break;

        case "access":
          if (parts.length < 2 || !/^\d+$/.test(parts[1])) {
            consoleEl.textContent += "Usage: access <SCP‑number>\n\n>> ";
            break;
          }
          const scpNum = parts[1];
          consoleEl.textContent += `Fetching data for SCP‑${scpNum}...\n`;
          try {
            const response = await fetch(`https://scp-data.tedivm.com/items/${scpNum}.json`);
            if (!response.ok) throw new Error("not found");
            const data = await response.json();
            consoleEl.textContent += `Title: ${data.title}\n`;
            consoleEl.textContent += `URL: ${data.url}\n`;
            let excerpt = (data.raw_content || "").split("\n").slice(0, 5).join("\n");
            consoleEl.textContent += `Excerpt:\n${excerpt}\n\n`;
          } catch (err) {
            consoleEl.textContent += `Error: Could not retrieve SCP‑${scpNum}. (${err.message})\n\n`;
          }
          consoleEl.textContent += ">> ";
          break;

        default:
          if (cmd) {
            consoleEl.textContent += `Unknown command: ${cmd}\nType 'help' for list of commands.\n\n`;
          }
          consoleEl.textContent += ">> ";
          break;
      }
    }

    function startCommandMode() {
      document.addEventListener('keydown', handleInput);
    }

    closeBtn.addEventListener('click', () => {
      popup.style.display = 'none';
    });

    // Start the boot sequence on load
    bootSequence();
  </script>
</body>
</html>
